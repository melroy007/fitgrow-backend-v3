<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FitTrack Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary: #FF6B35;
      --primary-dark: #E55A2B;
      --bg: #0F0F0F;
      --card: #1A1A1A;
      --light: #252525;
      --text: #FFFFFF;
      --muted: #A0A0A0;
      --border: #333;
    }
    body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); }
    .hidden { display: none !important; }

    /* MODAL */
    .modal { position: fixed; top:0; left:0; width:100%; height:100%; z-index:1000; display:flex; align-items:center; justify-content:center; }
    .overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); }
    .modal-box { position:relative; z-index:1; background:var(--card); border-radius:20px; width:90%; max-width:420px; border:1px solid var(--border); overflow:hidden; }
    .modal-head { padding:24px 28px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; }
    .modal-head h2 { font-size:22px; font-weight:800; }
    .modal-close { font-size:26px; cursor:pointer; color:var(--muted); background:none; border:none; color:var(--muted); }
    .modal-body { padding:28px; }
    .input { width:100%; padding:14px 18px; margin-bottom:14px; background:var(--light); border:2px solid var(--border); border-radius:10px; color:var(--text); font-size:15px; font-family:inherit; transition:border 0.3s; }
    .input:focus { outline:none; border-color:var(--primary); }
    .err { background:rgba(239,68,68,0.1); border:1px solid #ef4444; color:#ef4444; padding:12px; border-radius:8px; margin-bottom:14px; font-size:14px; }
    .toggle-text { text-align:center; margin-top:14px; color:var(--muted); font-size:14px; }
    .toggle-text a { color:var(--primary); text-decoration:none; font-weight:700; margin-left:5px; }

    /* LAYOUT */
    .app { display:flex; min-height:100vh; }

    /* SIDEBAR */
    .sidebar { width:250px; background:var(--card); border-right:1px solid var(--border); padding:24px 16px; display:flex; flex-direction:column; gap:20px; }
    .logo { display:flex; align-items:center; gap:10px; padding-bottom:20px; border-bottom:1px solid var(--border); }
    .logo span:first-child { font-size:26px; }
    .logo span:last-child { font-size:20px; font-weight:800; color:var(--primary); }
    .user-box { display:flex; align-items:center; gap:12px; padding:12px; background:var(--light); border-radius:12px; }
    .avatar { width:40px; height:40px; background:var(--primary); border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:18px; }
    .user-name { font-weight:700; font-size:14px; }
    .user-status { font-size:12px; color:var(--muted); }
    .nav { flex:1; display:flex; flex-direction:column; gap:4px; }
    .nav-btn { display:flex; align-items:center; gap:12px; padding:12px 14px; border-radius:10px; cursor:pointer; font-weight:600; font-size:14px; color:var(--muted); border:none; background:none; width:100%; text-align:left; transition:all 0.2s; }
    .nav-btn:hover { background:var(--light); color:var(--text); }
    .nav-btn.active { background:rgba(255,107,53,0.12); color:var(--primary); }
    .nav-icon { font-size:18px; }
    .sidebar-foot { border-top:1px solid var(--border); padding-top:16px; display:flex; flex-direction:column; gap:8px; }

    /* MAIN */
    .main { flex:1; padding:36px; overflow-y:auto; }
    .page { display:none; animation:fadeUp 0.3s; }
    .page.active { display:block; }
    @keyframes fadeUp { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
    .page-head { display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:28px; }
    .page-head h1 { font-size:32px; font-weight:800; }
    .page-head p { color:var(--muted); margin-top:4px; }

    /* STATS */
    .stats { display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px; margin-bottom:28px; }
    .stat { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:22px; cursor:pointer; transition:all 0.3s; }
    .stat:hover { border-color:var(--primary); transform:translateY(-4px); }
    .stat-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
    .stat-ico { width:46px; height:46px; background:var(--light); border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:22px; }
    .badge { background:rgba(255,107,53,0.12); color:var(--primary); padding:4px 10px; border-radius:20px; font-size:11px; font-weight:700; }
    .stat-label { font-size:11px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:6px; }
    .stat-val { font-size:40px; font-weight:800; margin-bottom:4px; transition:transform 0.2s; }
    .stat-goal { font-size:12px; color:var(--muted); margin-bottom:10px; }
    .prog { height:6px; background:var(--light); border-radius:10px; margin-bottom:12px; overflow:hidden; }
    .prog-bar { height:100%; background:var(--primary); border-radius:10px; transition:width 0.5s; width:0%; }
    .add-btn { padding:8px 16px; background:var(--primary); border:none; border-radius:8px; color:#fff; font-weight:700; font-size:12px; cursor:pointer; opacity:0; transition:all 0.2s; }
    .stat:hover .add-btn { opacity:1; }
    .add-btn:hover { background:var(--primary-dark); }

    /* ACTIONS */
    .action-card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:22px; margin-bottom:20px; }
    .action-card h3 { font-size:18px; font-weight:800; margin-bottom:16px; }
    .actions { display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:12px; }
    .act-btn { padding:16px; border:none; border-radius:12px; background:var(--primary); color:#fff; font-weight:700; font-size:14px; cursor:pointer; display:flex; flex-direction:column; align-items:center; gap:8px; transition:all 0.2s; }
    .act-btn:hover { background:var(--primary-dark); transform:translateY(-2px); }
    .act-btn.grey { background:var(--light); }
    .act-btn.grey:hover { background:#333; }
    .act-ico { font-size:28px; }

    /* STATUS */
    .status { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:14px 18px; display:flex; align-items:center; gap:12px; }
    .status-text strong { font-size:13px; color:#4ade80; display:block; }
    .status-text span { font-size:11px; color:var(--muted); }

    /* BUTTONS */
    .btn { padding:11px 22px; border:none; border-radius:10px; font-weight:700; font-size:14px; cursor:pointer; transition:all 0.2s; display:inline-flex; align-items:center; gap:8px; font-family:inherit; }
    .btn-primary { background:var(--primary); color:#fff; }
    .btn-primary:hover { background:var(--primary-dark); }
    .btn-outline { background:var(--light); color:var(--text); border:1px solid var(--border); }
    .btn-outline:hover { background:var(--primary); border-color:var(--primary); }
    .btn-full { width:100%; justify-content:center; }
    .btn-danger { background:#ef4444; color:#fff; }
    .btn-danger:hover { background:#dc2626; }

    /* SETTINGS */
    .settings-card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:24px; max-width:480px; }
    .settings-card h3 { font-size:18px; font-weight:800; margin-bottom:20px; }
    .form-group { margin-bottom:16px; }
    .form-group label { display:block; font-size:12px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:6px; }

    /* PLACEHOLDER */
    .ph-card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:60px 40px; text-align:center; }
    .ph-ico { font-size:72px; margin-bottom:18px; }
    .ph-card h2 { font-size:26px; font-weight:800; margin-bottom:10px; }
    .ph-card p { color:var(--muted); margin-bottom:22px; }

    @media(max-width:768px) {
      .app { flex-direction:column; }
      .sidebar { width:100%; }
      .main { padding:20px 16px; }
      .stats { grid-template-columns:1fr 1fr; }
    }
    @media(max-width:480px) {
      .stats { grid-template-columns:1fr; }
    }
  </style>
</head>
<body>

<!-- Auth Modal -->
<div id="authModal" class="modal hidden">
  <div class="overlay" onclick="closeAuth()"></div>
  <div class="modal-box">
    <div class="modal-head">
      <h2 id="authTitle">Login</h2>
      <button class="modal-close" onclick="closeAuth()">√ó</button>
    </div>
    <div class="modal-body">
      <input type="text" id="authUsername" class="input hidden" placeholder="Username">
      <input type="email" id="authEmail" class="input" placeholder="Email">
      <input type="password" id="authPassword" class="input" placeholder="Password">
      <div id="authError" class="err hidden"></div>
      <button id="authSubmitBtn" class="btn btn-primary btn-full" onclick="login()">Login</button>
      <p class="toggle-text">
        <span id="toggleText">Don't have an account?</span>
        <a href="#" onclick="toggleMode(event)">Sign Up</a>
      </p>
    </div>
  </div>
</div>

<!-- App -->
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo"><span>üí™</span><span>FitTrack</span></div>
    <div class="user-box">
      <div class="avatar">üë§</div>
      <div>
        <div class="user-name" id="userName">Guest</div>
        <div class="user-status" id="userStatus">Offline Mode</div>
      </div>
    </div>
    <nav class="nav">
      <button class="nav-btn active" onclick="go('dashboard',this)"><span class="nav-icon">üìä</span>Dashboard</button>
      <button class="nav-btn" onclick="go('scanner',this)"><span class="nav-icon">üì∏</span>Food Scanner</button>
      <button class="nav-btn" onclick="go('workouts',this)"><span class="nav-icon">üèãÔ∏è</span>Workouts</button>
      <button class="nav-btn" onclick="go('nutrition',this)"><span class="nav-icon">ü•ó</span>Nutrition</button>
      <button class="nav-btn" onclick="go('progress',this)"><span class="nav-icon">üìà</span>Progress</button>
      <button class="nav-btn" onclick="go('settings',this)"><span class="nav-icon">‚öôÔ∏è</span>Settings</button>
    </nav>
    <div class="sidebar-foot">
      <button class="btn btn-outline btn-full" id="loginBtn" onclick="showAuth()">üîê Login / Sign Up</button>
      <button class="btn btn-danger btn-full hidden" id="logoutBtn" onclick="doLogout()">üö™ Logout</button>
    </div>
  </aside>

  <!-- Main -->
  <main class="main">

    <!-- Dashboard -->
    <div id="dashboardPage" class="page active">
      <div class="page-head">
        <div><h1>Welcome back, Athlete! üî•</h1><p>Start your day strong - track your progress</p></div>
        <button class="btn btn-primary" onclick="syncData()">‚òÅÔ∏è Sync Data</button>
      </div>

      <div class="stats">
        <div class="stat" onclick="add('calories')">
          <div class="stat-top"><div class="stat-ico">üî•</div><div class="badge">+100</div></div>
          <div class="stat-label">Calories Burned</div>
          <div class="stat-val" id="calories">0</div>
          <div class="stat-goal">Goal: 3,000 kcal</div>
          <div class="prog"><div class="prog-bar" id="calProg"></div></div>
          <button class="add-btn" onclick="event.stopPropagation();add('calories')">+ Add 100</button>
        </div>
        <div class="stat" onclick="add('steps')">
          <div class="stat-top"><div class="stat-ico">üëü</div><div class="badge">+1000</div></div>
          <div class="stat-label">Steps Today</div>
          <div class="stat-val" id="steps">0</div>
          <div class="stat-goal">Goal: 10,000 steps</div>
          <div class="prog"><div class="prog-bar" id="stepsProg"></div></div>
          <button class="add-btn" onclick="event.stopPropagation();add('steps')">+ Add 1000</button>
        </div>
        <div class="stat" onclick="add('water')">
          <div class="stat-top"><div class="stat-ico">üíß</div><div class="badge">+0.5L</div></div>
          <div class="stat-label">Water Intake</div>
          <div class="stat-val" id="water">0.0L</div>
          <div class="stat-goal">Goal: 2.5L</div>
          <div class="prog"><div class="prog-bar" id="waterProg"></div></div>
          <button class="add-btn" onclick="event.stopPropagation();add('water')">+ Add 0.5L</button>
        </div>
        <div class="stat" onclick="add('sleep')">
          <div class="stat-top"><div class="stat-ico">üò¥</div><div class="badge">+1hr</div></div>
          <div class="stat-label">Sleep</div>
          <div class="stat-val" id="sleep">0.0h</div>
          <div class="stat-goal">Goal: 8h</div>
          <div class="prog"><div class="prog-bar" id="sleepProg"></div></div>
          <button class="add-btn" onclick="event.stopPropagation();add('sleep')">+ Add 1hr</button>
        </div>
      </div>

      <div class="action-card">
        <h3>Quick Actions</h3>
        <div class="actions">
          <button class="act-btn" onclick="go('workouts',null)"><span class="act-ico">üèãÔ∏è</span>Log Workout</button>
          <button class="act-btn" onclick="go('scanner',null)"><span class="act-ico">üì∏</span>Scan Food</button>
          <button class="act-btn" onclick="add('water')"><span class="act-ico">üíß</span>Add Water</button>
          <button class="act-btn grey" onclick="resetDay()"><span class="act-ico">üîÑ</span>Reset Day</button>
        </div>
      </div>

      <div class="status">
        <span style="font-size:20px">‚úÖ</span>
        <div class="status-text">
          <strong>Backend Connected</strong>
          <span>https://fitgrow-backend-v3.onrender.com</span>
        </div>
      </div>
    </div>

    <!-- Scanner -->
    <div id="scannerPage" class="page">
      <div class="page-head"><div><h1>Food Scanner üì∏</h1><p>AI-powered food recognition</p></div></div>
      <div class="ph-card"><div class="ph-ico">üì∏</div><h2>Scan Your Food</h2><p>Use your camera to scan food and get instant nutritional info</p><button class="btn btn-primary" onclick="alert('Camera feature - connect camera API here!')">üì∑ Open Camera</button></div>
    </div>

    <!-- Workouts -->
    <div id="workoutsPage" class="page">
      <div class="page-head"><div><h1>Workouts üèãÔ∏è</h1><p>Track your exercises</p></div></div>
      <div class="ph-card"><div class="ph-ico">üèãÔ∏è</div><h2>Log Your Workout</h2><p>Track your sets, reps, and duration</p><button class="btn btn-primary" onclick="alert('Workout logged!')">+ Log Workout</button></div>
    </div>

    <!-- Nutrition -->
    <div id="nutritionPage" class="page">
      <div class="page-head"><div><h1>Nutrition ü•ó</h1><p>Track your daily nutrition</p></div></div>
      <div class="ph-card"><div class="ph-ico">ü•ó</div><h2>Nutrition Tracker</h2><p>Monitor your macros and calories</p><button class="btn btn-primary" onclick="alert('Meal added!')">+ Add Meal</button></div>
    </div>

    <!-- Progress -->
    <div id="progressPage" class="page">
      <div class="page-head"><div><h1>Progress üìà</h1><p>Your fitness journey over time</p></div></div>
      <div class="ph-card"><div class="ph-ico">üìà</div><h2>Progress Analytics</h2><p>Charts and insights about your fitness</p><button class="btn btn-primary" onclick="alert('Charts loading!')">View Charts</button></div>
    </div>

    <!-- Settings -->
    <div id="settingsPage" class="page">
      <div class="page-head"><div><h1>Settings ‚öôÔ∏è</h1><p>Customize your experience</p></div></div>
      <div class="settings-card">
        <h3>Daily Goals</h3>
        <div class="form-group"><label>Calories (kcal)</label><input type="number" id="gCal" class="input" value="3000"></div>
        <div class="form-group"><label>Steps</label><input type="number" id="gSteps" class="input" value="10000"></div>
        <div class="form-group"><label>Water (L)</label><input type="number" id="gWater" class="input" value="2.5" step="0.1"></div>
        <div class="form-group"><label>Sleep (hours)</label><input type="number" id="gSleep" class="input" value="8" step="0.5"></div>
        <button class="btn btn-primary" onclick="saveGoals()">üíæ Save Goals</button>
      </div>
    </div>

  </main>
</div>

<script>
const API = 'https://fitgrow-backend-v3.onrender.com/api';
let token = localStorage.getItem('token');
let user = JSON.parse(localStorage.getItem('user') || 'null');
const goals = { calories:3000, steps:10000, water:2.5, sleep:8 };

// Init
if(token && user) updateUI();

// Navigation
function go(page, btn) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(page+'Page').classList.add('active');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  if(btn) btn.classList.add('active');
  else {
    document.querySelectorAll('.nav-btn').forEach(b => {
      if(b.textContent.toLowerCase().includes(page)) b.classList.add('active');
    });
  }
}

// Add stats
function add(type) {
  const vals = {calories:100, steps:1000, water:0.5, sleep:1};
  const progs = {calories:'calProg', steps:'stepsProg', water:'waterProg', sleep:'sleepProg'};
  const el = document.getElementById(type);
  let v = parseFloat(el.textContent) || 0;
  v += vals[type];
  if(type==='water') el.textContent = v.toFixed(1)+'L';
  else if(type==='sleep') el.textContent = v.toFixed(1)+'h';
  else el.textContent = Math.round(v);
  // Progress
  const pct = Math.min((v/goals[type])*100,100);
  document.getElementById(progs[type]).style.width = pct+'%';
  // Animation
  el.style.transform='scale(1.15)';
  setTimeout(()=>el.style.transform='scale(1)',200);
}

function resetDay() {
  if(!confirm('Reset all data for today?')) return;
  ['calories','steps'].forEach(t=>document.getElementById(t).textContent='0');
  ['water'].forEach(t=>document.getElementById(t).textContent='0.0L');
  ['sleep'].forEach(t=>document.getElementById(t).textContent='0.0h');
  ['calProg','stepsProg','waterProg','sleepProg'].forEach(id=>document.getElementById(id).style.width='0%');
}

// Auth
function showAuth() { document.getElementById('authModal').classList.remove('hidden'); }
function closeAuth() { document.getElementById('authModal').classList.add('hidden'); document.getElementById('authError').classList.add('hidden'); }

function toggleMode(e) {
  e.preventDefault();
  const title = document.getElementById('authTitle');
  const btn = document.getElementById('authSubmitBtn');
  const txt = document.getElementById('toggleText');
  const un = document.getElementById('authUsername');
  if(title.textContent==='Login') {
    title.textContent='Sign Up'; btn.textContent='Sign Up'; btn.onclick=signup;
    txt.textContent='Already have an account?'; un.classList.remove('hidden');
  } else {
    title.textContent='Login'; btn.textContent='Login'; btn.onclick=login;
    txt.textContent="Don't have an account?"; un.classList.add('hidden');
  }
}

function showErr(msg) {
  const el = document.getElementById('authError');
  el.textContent=msg; el.classList.remove('hidden');
}

async function login() {
  const email = document.getElementById('authEmail').value;
  const pass = document.getElementById('authPassword').value;
  if(!email||!pass) { showErr('Please fill all fields'); return; }
  try {
    const r = await fetch(`${API}/auth/login`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,password:pass})});
    const d = await r.json();
    if(d.success) { token=d.token; user=d.user; localStorage.setItem('token',token); localStorage.setItem('user',JSON.stringify(user)); updateUI(); closeAuth(); alert('‚úÖ Login successful! Welcome back '+user.username+'!'); }
    else showErr(d.message||'Login failed');
  } catch(e) { showErr('Network error. Try again.'); }
}

async function signup() {
  const username = document.getElementById('authUsername').value;
  const email = document.getElementById('authEmail').value;
  const pass = document.getElementById('authPassword').value;
  if(!username||!email||!pass) { showErr('Please fill all fields'); return; }
  try {
    const r = await fetch(`${API}/auth/signup`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,email,password:pass})});
    const d = await r.json();
    if(d.success) { token=d.token; user=d.user; localStorage.setItem('token',token); localStorage.setItem('user',JSON.stringify(user)); updateUI(); closeAuth(); alert('‚úÖ Account created! Welcome '+user.username+'!'); }
    else showErr(d.message||'Signup failed');
  } catch(e) { showErr('Network error. Try again.'); }
}

function doLogout() {
  if(!confirm('Logout?')) return;
  token=null; user=null;
  localStorage.removeItem('token'); localStorage.removeItem('user');
  updateUI(); resetDay(); alert('‚úÖ Logged out!');
}

function updateUI() {
  document.getElementById('userName').textContent = user ? user.username : 'Guest';
  document.getElementById('userStatus').textContent = user ? 'Online ‚úÖ' : 'Offline Mode';
  document.getElementById('loginBtn').classList.toggle('hidden', !!user);
  document.getElementById('logoutBtn').classList.toggle('hidden', !user);
}

async function syncData() {
  if(!token) { alert('‚ö†Ô∏è Please login first!'); showAuth(); return; }
  const cal = parseInt(document.getElementById('calories').textContent)||0;
  const steps = parseInt(document.getElementById('steps').textContent)||0;
  const water = parseFloat(document.getElementById('water').textContent)||0;
  const sleep = parseFloat(document.getElementById('sleep').textContent)||0;
  try {
    if(cal>0) await fetch(`${API}/health/activity`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify({type:'calories',value:cal})});
    alert(`‚úÖ Synced to cloud!\n\nCalories: ${cal}\nSteps: ${steps}\nWater: ${water}L\nSleep: ${sleep}h`);
  } catch(e) { alert('‚ùå Sync failed'); }
}

function saveGoals() {
  goals.calories = parseInt(document.getElementById('gCal').value)||3000;
  goals.steps = parseInt(document.getElementById('gSteps').value)||10000;
  goals.water = parseFloat(document.getElementById('gWater').value)||2.5;
  goals.sleep = parseFloat(document.getElementById('gSleep').value)||8;
  alert('‚úÖ Goals saved!');
}
</script>
</body>
</html>
